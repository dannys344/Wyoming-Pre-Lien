<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wyoming Notice Letter Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, textarea, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 80px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        .preview-container {
            margin-top: 30px;
            border: 1px solid #ddd;
            padding: 20px;
            background-color: white;
        }
        .hidden {
            display: none;
        }
        #previewLetter {
            font-family: 'Times New Roman', Times, serif;
            font-size: 12pt;
            line-height: 1.5;
            white-space: pre-wrap;
        }
        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .tab {
            overflow: hidden;
            border: 1px solid #ccc;
            background-color: #f1f1f1;
            margin-bottom: 20px;
        }
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            color: black;
        }
        .tab button:hover {
            background-color: #ddd;
        }
        .tab button.active {
            background-color: #ccc;
        }
        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Wyoming Notice Letter Generator</h1>

        <div class="tab">
            <button class="tablinks active" onclick="openTab(event, 'NoticeLetterInfo')">Notice Letter Info</button>
            <button class="tablinks" onclick="openTab(event, 'NoticeLetterPreview')">Notice Letter Preview</button>
        </div>

        <!-- NOTICE LETTER FORM -->
        <div id="NoticeLetterInfo" class="tabcontent" style="display: block;">
            <!-- 1. Current Date (auto-populated) -->
            <div class="form-group">
                <label for="letterDate">Current Date:</label>
                <input type="text" id="letterDate" readonly>
            </div>

            <!-- 2. Certified Mail Number -->
            <div class="form-group">
                <label for="certifiedMailNumber">Certified Mail Number:</label>
                <input type="text" id="certifiedMailNumber" placeholder="Enter certified mail number">
            </div>

            <!-- 3. Customer Name -->
            <div class="form-group">
                <label for="customerName">Customer Name:</label>
                <input type="text" id="customerName" placeholder="Enter customer name">
            </div>

            <!-- 4. Property Address -->
            <div class="form-group">
                <label for="propertyAddress">Property Address:</label>
                <input type="text" id="propertyAddress" placeholder="Enter property address">
            </div>

            <div class="buttons">
                <button onclick="generateNoticeLetterPreview()">Preview Notice Letter</button>
            </div>
        </div>

        <!-- NOTICE LETTER PREVIEW -->
        <div id="NoticeLetterPreview" class="tabcontent">
            <div id="previewLetter"></div>
            <div class="buttons">
                <button onclick="goBackToForm()">Edit Form</button>
                <button onclick="generatePDF()">Download PDF</button>
            </div>
        </div>
    </div>

    <script>
        // Set current date for notice letter
        window.onload = function() {
            const today = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('letterDate').value = today.toLocaleDateString('en-US', options);
        };

        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        function goBackToForm() {
            openTab(event, 'NoticeLetterInfo');
            document.querySelector('.tablinks').classList.add('active');
            document.querySelector('.tablinks:nth-child(2)').classList.remove('active');
        }

        function generateNoticeLetterPreview() {
            const letterDate = document.getElementById('letterDate').value || '[Date Not Provided]';
            const certifiedMailNumber = document.getElementById('certifiedMailNumber').value || '[Certified Mail Number Not Provided]';
            const customerName = document.getElementById('customerName').value || '[Customer Name Not Provided]';
            const propertyAddress = document.getElementById('propertyAddress').value || '[Property Address Not Provided]';

            const letterContent = `<div style="white-space: pre-wrap; font-family: 'Times New Roman', Times, serif; line-height: 1.5;">${letterDate}

VIA CERTIFIED MAIL

# {certifiedMailNumber}

Name: {customerName}

Address: {propertyAddress}

To Whom It May Concern:

Thank you for choosing View Point. We appreciate your business and look forward to working with you!

Because View Point is providing work and/or materials to your property, we are required by the State of Wyoming to provide you with the enclosed document and form Lien Waiver. This is **not** a Notice of Lien; our intention is to inform the property owner of The State of Wyoming's law of our Right to Lien should payment not be completed. No action is required by you. If needed, we can issue you a completed Lien Waiver upon the final payment of View Point invoice(s).

If there are questions or concerns, please contact Michele Clark: (208) 854-1877

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAA8CAYAAACMhGHSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAWXSURBVHgB7ZvNbxtVFMXPm3HtJHYbElJFJaSKDUggFSGxYtV/qF3Un8qCPRISpSpdsGCBBKhqG5LEjj2+s3gzY6d1GiUZv/HHOdKRJx9+8bNn7r3n3vsUEARBEARBEARBEARBEARBEIQJyHCPWFsre/b16o9Hrq2tlXvwxqfG4OTYvs4qZC9BHxhfCqhbQmcDWJlBef95/DBdDaKcm8Zgf41GdY7s7j7eqQ8kWP8hAVrYO+QPKyhRoUDUQlU1aDSekYoA3gFlS8Ls/NNNBOg3kBw/wW5XUN67RJXnCO0qXg0PcPhoFVXn0XDU6XwQJFhvgLVU8fgvBSxrkLVN4cXoFPsdisyzC9RjJ6iLBVRFEyX6GM7oBDH3IM9Og54fGnKnKOLfGCd1VOkiPdXDsFvH7s5TtJ88TN9lnuMF6X3uLdX9Qa9TLTtfq05xQ+OXlh1lzTcfA7Msn+vwIw3KAnnpnwfXaafRQmU6yPwWAu8UVbQ/TFzswPde86V4ZN4aQqHAT7XmyP3wfdSpZUHT0fXQYLBTYZU45L/NuXeGHBf2aIEQN+kbB6GZO0HZ7GJoXs/Sn7B9XFWuq8/lYy6NNXvCTR+bpWUxvPOIlalO389+OBxj+8kBHj6q4vHjOZRUZJPTPhVjd5qPVqhqFlC2dHtKCmWM8/XUuRK09XXDC1oVfb+KPFGg/oBUxXPK3BUiWpzs+xQ1d4CRe2nvmcYzfZlMiV1XVdNPNurhGQbBAfrxfH0JlzL/+bwbRTdVPDMq3F29kS7QwI7RaC2SKpxiZ+dJ+tzHh59icNhCb7+Jk+Mn6TWfr9Pjy+4dTF3VfZ7fWvcPqtg+aKe/E/trtC8Pv2YysFe6MKQy+RKM13QLXdG5fY+UJ0SJnuGvlefDezGeMV/gdbFdUgJXppOSZYZFdm9JK3WDOw5H+N2gzmz8s+hHVQpChaJt8XyxdoSP+j72Dw4wiun4PUfXr1z10JU9LXw3C/vZ2j5OYQ3LL8/U9E85JXgbLt+vqH2Y2ZrVOGb9uMYxQn2gI3qZdxh4JTHPYzrxHIZdPNvfxvKD35BlMRWw/qEpnWzx/G666d5QhHHSMh9Mc2m2xmeXVdvQ0WTqFjMqaR29Rl6wjUmfT68vLI29Z3VaUvPoHcOzgM6kOoIoUQUcjIGW3zXqPaLvRCbT8Xz9K9x5EaFZXaGc0MGzlV3hQNVdTw9hGNH7uIEwIcwkczIytj5EZ3u5Frs6H7wIBL83GqX1q7sGzNyHOLVnZ1B0YTyFwsK4RlGdGaO3i+r4OTWX3YzGaZ7tqffqIzbbUwGl+UoNLKUsjO12msjE/eHrz5H3uwiC8zQIFCeXgkGd5+2hqZ5Tg+VcDy5lfbz0HE0r86Q+XMUyC2KUp2HT6/HTlrqtcRCozFPz1aAQsZitJYsJLisBbdWb2OmSOtYCgwZGMW31yWpwnXtLpfZQCwFLW9xqyLnfGnN1gvL2L5hfXKAOTXZNYDtWVMN22TwtwS+YHwLKOe+Z0aK2oOQoL1dGT/Fg5SWCYJsWdJfUq5qDQZTWyqX1uFAFZV3bM0vf5HcXTbWoIqqsj57jS53YrCxRQe5T4Z8hClv01D20O8eIbJeyc4Sk3KCO3LCCLnm3Xna1KmLT1qA+K0t1lOSLX9PoHrJcvZmqPm9RDTrLR6QshwjCYxgTIAx2EdodjZkiuiMnf11Z6Gj3VofDL2FMmD7wvX66I+r/6AkzJsUFArcDc+c0hl5ZMJHVdTMkZnGNQuHMKIp58OomBjGF0Vs/r2q57tEd0Dxq/jWe3aIjUiehk4B79DvN5f90siAIgiAIgiAIgiAIgiAIgiDMPP8ARM1JRk5lousAAAAASUVORK5CYII=" alt="Signature" style="max-width: 150px; margin-bottom: -15px;">

___________________
Jay L. Singleton
View Point, COO

JLS/mc

cc: General Contractor</div>`;

            document.getElementById('previewLetter').innerHTML = letterContent;
            openTab(event, 'NoticeLetterPreview');
            document.querySelector('.tablinks').classList.remove('active');
            document.querySelector('.tablinks:nth-child(2)').classList.add('active');
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF({
                orientation: 'portrait',
                unit: 'mm',
                format: 'letter'
            });

            const previewElement = document.getElementById('previewLetter');
            
            // Create a temporary div with proper styling for PDF generation
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = previewElement.innerHTML;
            tempDiv.style.width = '180mm';
            tempDiv.style.padding = '15mm';
            tempDiv.style.fontFamily = 'Times New Roman';
            tempDiv.style.fontSize = '12pt';
            tempDiv.style.lineHeight = '1.5';
            tempDiv.style.whiteSpace = 'pre-wrap';
            tempDiv.style.position = 'absolute';
            tempDiv.style.left = '-9999px';
            document.body.appendChild(tempDiv);

            html2canvas(tempDiv, {
                scale: 2,
                logging: false
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/jpeg', 1.0);
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 297; // A4 height in mm
                const imgHeight = canvas.height * imgWidth / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;

                doc.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    doc.addPage();
                    doc.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                doc.save('wyoming-notice-letter.pdf');
                document.body.removeChild(tempDiv);
            });
        }
    </script>
</body>
</html>
