function generateWordDoc(type) {
    // Determine document content based on type
    let filename = '';
    const propertyAddress = document.getElementById('propertyAddress').value || 'unknown-address';
    const sanitizedAddress = propertyAddress.replace(/[^\w\s]/gi, '').replace(/\s+/g, '-');
    
    // Get all the form field values
    const projectNameInput = document.getElementById('projectName').value;
    const projectName = projectNameInput || propertyAddress;
    const county = document.getElementById('county').value || '[County Not Provided]';
    const parcelId = document.getElementById('parcelId').value || '[Parcel ID Not Provided]';
    const legalDescription = document.getElementById('legalDescription').value || '[Legal Description Not Provided]';
    const contractorInfo = document.getElementById('contractorInfo').value || '[Contractor Information Not Provided]';
    const contractorAddress = document.getElementById('contractorAddress').value || '[Contractor Address Not Provided]';
    const totalContractCost = document.getElementById('totalContractCost').value || '[Amount Not Provided]';
    const currentDate = formatDate(document.getElementById('currentDate').value);
    const dayOfMonth = document.getElementById('dayOfMonth').value || '[Day Not Provided]';
    const currentMonth = document.getElementById('currentMonth').value;
    const currentYear = document.getElementById('currentYear').value || '[Year Not Provided]';
    const fullContractorInfo = `${contractorInfo}\n${contractorAddress}`;
    
    // Create a simple HTML content for the document
    let content = '';
    
    if (type === 'lien') {
        filename = `Notice-of-Right-to-Lien-${sanitizedAddress}.docx`;
        content = `
            <html>
                <body>
                    <div style="font-family: Times New Roman; font-size: 12pt;">
                        <div style="text-align: center; font-weight: bold;">NOTICE TO OWNER</div>
                        <p>The undersigned party is providing work or materials to the property described below...</p>
                        <!-- Include all your lien notice content here -->
                    </div>
                </body>
            </html>
        `;
    } else if (type === 'letter') {
        const letterDate = document.getElementById('letterDate').value;
        const certifiedMailNumber = document.getElementById('certifiedMailNumber').value || '[Certified Mail Number Not Provided]';
        const customerName = document.getElementById('customerName').value || '[Customer Name Not Provided]';
        const letterPropertyAddress = document.getElementById('letterPropertyAddress').value || '[Property Address Not Provided]';

        filename = `Notice-Letter-${sanitizedAddress}.docx`;
        content = `
            <html>
                <body>
                    <div style="font-family: Times New Roman; font-size: 12pt;">
                        <div style="text-align: center;">
                            <strong>View Point, Inc.</strong><br>
                            6715 W. State Street • Boise, ID. 83714<br>
                            Telephone (208) 854-1877 • Fax (208) 854-1878<br>
                            www.viewpointwindows.com
                        </div>
                        <p>${letterDate}</p>
                        <p>VIA CERTIFIED MAIL<br>
                        # ${certifiedMailNumber}</p>
                        <p>Name: ${customerName}<br>
                        Address: ${letterPropertyAddress}</p>
                        <p>To Whom It May Concern:</p>
                        <p>Thank you for choosing View Point...</p>
                        <!-- Include all your letter content here -->
                    </div>
                </body>
            </html>
        `;
    }

    // Convert HTML to DOCX
    const converted = htmlDocx.asBlob(content);
    
    // Save the file
    saveAs(converted, filename);
}
